{% extends "base.html" %}
{% block title %}Submit - Surveys{% endblock %}
{% block content %}
<!--The following site provided a Django project blueprint to build a survey app. This was
   followed alongside the git hub page. I then customised the HTML and CSS to align with my
   site's design and functionality. https://mattsegal.dev/django-survey-project.html. This form
   does not use crispy forms but formset.management as per the default set up.-->
<div class="container">
   <div class="row-fluid align-items-center">
      <div class="col-md-12 mt-3">
         <!--The second page within the survey will take the user to answer the  questions added by the user.
            These are radio button options which the user will need to select between.-->
         <div class="col-md-6 mx-auto card-with-background mb-5 px-5 pt-5">
            <h2 class="card-title bolder mt-5">Your answers to {{ survey.title }}</h2>
            <form method="post" novalidate>
               {% csrf_token %}
               {{ formset.management_form }}
               <!--A for loop will return all created questions and their options -->
               {% for question, form in question_forms %}
               <div class="ui basic padded segment left aligned">
                  <div class="ui form {% if form.errors %}error{% endif %}">
                     <h3 class="ui header bolder">
                        Question {{ forloop.counter }}: {{ question.question }}
                     </h3>
                     {% for field in form %}
                     <div class="field {% if field.errors %}error{% endif %}">
                        {{ field }}
                     </div>
                     {% endfor %}
                     <!--An if statement and two for statements are utilised to provide an  error message per field and non-fields only if any 
                        errors occur.-->
                     {% if form.errors %}
                     <div class="ui message error">
                        <div class="header">We had some issues</div>
                        <ul class="list">
                           {% for field in form %}
                           {% for error in field.errors %}
                           <li>{{ field.label_tag }} {{ error }}</li>
                           {% endfor %}
                           {% endfor %}
                           {% for error in form.non_field_errors %}
                           <li>{{ error }}</li>
                           {% endfor %}
                        </ul>
                     </div>
                     {% endif %}
                  </div>
               </div>
               {% endfor %}
               <button type="submit" class="btn mb-3 mr-1 get-started">Submit</button>
               <!--The Cancel button will return the user to the site's home page-->
               <div><a class="btn mb-5 mr-1 get-started" href="{% url 'home' %}" role="button">Cancel and Return
                  Home</a>
               </div>
            </form>
         </div>
      </div>
   </div>
</div>
{% endblock %}